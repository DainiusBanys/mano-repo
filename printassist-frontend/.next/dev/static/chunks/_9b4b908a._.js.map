{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Coding/mano-repo/printassist-frontend/context/AuthContext.tsx"],"sourcesContent":["// context/AuthContext.tsx\r\n\r\nimport React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\r\nimport axios from 'axios';\r\n\r\n// Get the backend URL from the frontend environment\r\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL;\r\n\r\n// --- 1. Define Types ---\r\ninterface User {\r\n    id: string;\r\n    email: string;\r\n    isSubscribed: boolean;\r\n}\r\n\r\ninterface AuthContextType {\r\n    user: User | null;\r\n    token: string | null;\r\n    isAuthenticated: boolean;\r\n    login: (token: string, user: User) => void;\r\n    logout: () => void;\r\n    registerUser: (email: string, password: string) => Promise<void>;\r\n    loginUser: (email: string, password: string) => Promise<void>;\r\n}\r\n\r\n// --- 2. Create Context ---\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\n// Hook to use the context\r\nexport const useAuth = () => {\r\n    const context = useContext(AuthContext);\r\n    if (context === undefined) {\r\n        throw new Error('useAuth must be used within an AuthProvider');\r\n    }\r\n    return context;\r\n};\r\n\r\n// --- 3. Provider Component ---\r\nexport const AuthProvider: React.FC<{ children: ReactNode }> = ({ children }) => {\r\n    const [user, setUser] = useState<User | null>(null);\r\n    const [token, setToken] = useState<string | null>(null);\r\n\r\n    // Load state from localStorage on initial load\r\n    useEffect(() => {\r\n        const storedToken = localStorage.getItem('token');\r\n        const storedUser = localStorage.getItem('user');\r\n\r\n        if (storedToken && storedUser) {\r\n            setToken(storedToken);\r\n            setUser(JSON.parse(storedUser));\r\n        }\r\n    }, []);\r\n\r\n    const login = (newToken: string, newUser: User) => {\r\n        setToken(newToken);\r\n        setUser(newUser);\r\n        localStorage.setItem('token', newToken);\r\n        localStorage.setItem('user', JSON.stringify(newUser));\r\n    };\r\n\r\n    const logout = () => {\r\n        setToken(null);\r\n        setUser(null);\r\n        localStorage.removeItem('token');\r\n        localStorage.removeItem('user');\r\n    };\r\n\r\n    // --- API Interactions ---\r\n\r\n    const registerUser = async (email: string, password: string) => {\r\n        try {\r\n            const response = await axios.post(`${API_BASE_URL}/auth/register`, { email, password });\r\n\r\n            // NOTE: The registration response currently doesn't return a token, \r\n            // so the user must be redirected to log in after success.\r\n            if (response.status === 201) {\r\n                // Successful registration\r\n                console.log('Registration successful, please log in.');\r\n            }\r\n\r\n        } catch (error) {\r\n            if (axios.isAxiosError(error) && error.response) {\r\n                throw new Error(error.response.data.msg || 'Registration failed.');\r\n            }\r\n            throw new Error('An unknown error occurred during registration.');\r\n        }\r\n    };\r\n\r\n    const loginUser = async (email: string, password: string) => {\r\n        try {\r\n            const response = await axios.post(`${API_BASE_URL}/auth/login`, { email, password });\r\n\r\n            const { token: newToken, user: newUser } = response.data;\r\n\r\n            // Set global state and localStorage\r\n            login(newToken, newUser);\r\n\r\n        } catch (error) {\r\n            if (axios.isAxiosError(error) && error.response) {\r\n                throw new Error(error.response.data.msg || 'Login failed.');\r\n            }\r\n            throw new Error('An unknown error occurred during login.');\r\n        }\r\n    };\r\n\r\n\r\n    const value: AuthContextType = {\r\n        user,\r\n        token,\r\n        isAuthenticated: !!user && !!token,\r\n        login,\r\n        logout,\r\n        registerUser,\r\n        loginUser,\r\n    };\r\n\r\n    return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n};"],"names":[],"mappings":"AAAA,0BAA0B;;;;;;;AAML;;AAJrB;AACA;;;;;AAEA,oDAAoD;AACpD,MAAM;AAmBN,4BAA4B;AAC5B,MAAM,4BAAc,IAAA,8KAAa,EAA8B;AAGxD,MAAM,UAAU;;IACnB,MAAM,UAAU,IAAA,2KAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACvB,MAAM,IAAI,MAAM;IACpB;IACA,OAAO;AACX;GANa;AASN,MAAM,eAAkD,CAAC,EAAE,QAAQ,EAAE;;IACxE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAc;IAC9C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAElD,+CAA+C;IAC/C,IAAA,0KAAS;kCAAC;YACN,MAAM,cAAc,aAAa,OAAO,CAAC;YACzC,MAAM,aAAa,aAAa,OAAO,CAAC;YAExC,IAAI,eAAe,YAAY;gBAC3B,SAAS;gBACT,QAAQ,KAAK,KAAK,CAAC;YACvB;QACJ;iCAAG,EAAE;IAEL,MAAM,QAAQ,CAAC,UAAkB;QAC7B,SAAS;QACT,QAAQ;QACR,aAAa,OAAO,CAAC,SAAS;QAC9B,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC;IAChD;IAEA,MAAM,SAAS;QACX,SAAS;QACT,QAAQ;QACR,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;IAC5B;IAEA,2BAA2B;IAE3B,MAAM,eAAe,OAAO,OAAe;QACvC,IAAI;YACA,MAAM,WAAW,MAAM,mJAAK,CAAC,IAAI,CAAC,GAAG,aAAa,cAAc,CAAC,EAAE;gBAAE;gBAAO;YAAS;YAErF,qEAAqE;YACrE,0DAA0D;YAC1D,IAAI,SAAS,MAAM,KAAK,KAAK;gBACzB,0BAA0B;gBAC1B,QAAQ,GAAG,CAAC;YAChB;QAEJ,EAAE,OAAO,OAAO;YACZ,IAAI,mJAAK,CAAC,YAAY,CAAC,UAAU,MAAM,QAAQ,EAAE;gBAC7C,MAAM,IAAI,MAAM,MAAM,QAAQ,CAAC,IAAI,CAAC,GAAG,IAAI;YAC/C;YACA,MAAM,IAAI,MAAM;QACpB;IACJ;IAEA,MAAM,YAAY,OAAO,OAAe;QACpC,IAAI;YACA,MAAM,WAAW,MAAM,mJAAK,CAAC,IAAI,CAAC,GAAG,aAAa,WAAW,CAAC,EAAE;gBAAE;gBAAO;YAAS;YAElF,MAAM,EAAE,OAAO,QAAQ,EAAE,MAAM,OAAO,EAAE,GAAG,SAAS,IAAI;YAExD,oCAAoC;YACpC,MAAM,UAAU;QAEpB,EAAE,OAAO,OAAO;YACZ,IAAI,mJAAK,CAAC,YAAY,CAAC,UAAU,MAAM,QAAQ,EAAE;gBAC7C,MAAM,IAAI,MAAM,MAAM,QAAQ,CAAC,IAAI,CAAC,GAAG,IAAI;YAC/C;YACA,MAAM,IAAI,MAAM;QACpB;IACJ;IAGA,MAAM,QAAyB;QAC3B;QACA;QACA,iBAAiB,CAAC,CAAC,QAAQ,CAAC,CAAC;QAC7B;QACA;QACA;QACA;IACJ;IAEA,qBAAO,6LAAC,YAAY,QAAQ;QAAC,OAAO;kBAAQ;;;;;;AAChD;IA/Ea;KAAA"}},
    {"offset": {"line": 124, "column": 0}, "map": {"version":3,"sources":["file:///D:/Coding/mano-repo/printassist-frontend/app/register/page.tsx"],"sourcesContent":["// app/register/page.tsx\r\n\r\n'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport Link from 'next/link';\r\n\r\nexport default function RegisterPage() {\r\n    const [email, setEmail] = useState('');\r\n    const [password, setPassword] = useState('');\r\n    const [error, setError] = useState('');\r\n    const { registerUser } = useAuth();\r\n    const router = useRouter();\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setError('');\r\n\r\n        try {\r\n            await registerUser(email, password);\r\n\r\n            // Successful registration: Redirect to login page\r\n            alert('Registration successful! Please log in.');\r\n            router.push('/login');\r\n\r\n        } catch (err) {\r\n            setError(err instanceof Error ? err.message : 'An error occurred.');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\r\n            <div className=\"max-w-md w-full p-6 space-y-8 bg-white shadow-md rounded-lg\">\r\n                <h2 className=\"text-2xl font-bold text-center text-gray-900\">\r\n                    Sign up for PrintAssist AI\r\n                </h2>\r\n\r\n                {error && (\r\n                    <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative\" role=\"alert\">\r\n                        <span className=\"block sm:inline\">{error}</span>\r\n                    </div>\r\n                )}\r\n\r\n                <form className=\"mt-8 space-y-6\" onSubmit={handleSubmit}>\r\n                    <div>\r\n                        <label htmlFor=\"email\" className=\"sr-only\">\r\n                            Email address\r\n                        </label>\r\n                        <input\r\n                            id=\"email\"\r\n                            name=\"email\"\r\n                            type=\"email\"\r\n                            autoComplete=\"email\"\r\n                            required\r\n                            value={email}\r\n                            onChange={(e) => setEmail(e.target.value)}\r\n                            className=\"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm\"\r\n                            placeholder=\"Email address\"\r\n                        />\r\n                    </div>\r\n                    <div>\r\n                        <label htmlFor=\"password\" className=\"sr-only\">\r\n                            Password\r\n                        </label>\r\n                        <input\r\n                            id=\"password\"\r\n                            name=\"password\"\r\n                            type=\"password\"\r\n                            autoComplete=\"new-password\"\r\n                            required\r\n                            value={password}\r\n                            onChange={(e) => setPassword(e.target.value)}\r\n                            className=\"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm\"\r\n                            placeholder=\"Password\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div>\r\n                        <button\r\n                            type=\"submit\"\r\n                            className=\"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\r\n                        >\r\n                            Register\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n\r\n                <div className=\"text-sm text-center\">\r\n                    Already have an account?{' '}\r\n                    <Link href=\"/login\" className=\"font-medium text-indigo-600 hover:text-indigo-500\">\r\n                        Sign in\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}"],"names":[],"mappings":"AAAA,wBAAwB;;;;;;AAIxB;AACA;AACA;AACA;;;AALA;;;;;AAOe,SAAS;;IACpB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IACzC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAA,qIAAO;IAChC,MAAM,SAAS,IAAA,kJAAS;IAExB,MAAM,eAAe,OAAO;QACxB,EAAE,cAAc;QAChB,SAAS;QAET,IAAI;YACA,MAAM,aAAa,OAAO;YAE1B,kDAAkD;YAClD,MAAM;YACN,OAAO,IAAI,CAAC;QAEhB,EAAE,OAAO,KAAK;YACV,SAAS,eAAe,QAAQ,IAAI,OAAO,GAAG;QAClD;IACJ;IAEA,qBACI,6LAAC;QAAI,WAAU;kBACX,cAAA,6LAAC;YAAI,WAAU;;8BACX,6LAAC;oBAAG,WAAU;8BAA+C;;;;;;gBAI5D,uBACG,6LAAC;oBAAI,WAAU;oBAA2E,MAAK;8BAC3F,cAAA,6LAAC;wBAAK,WAAU;kCAAmB;;;;;;;;;;;8BAI3C,6LAAC;oBAAK,WAAU;oBAAiB,UAAU;;sCACvC,6LAAC;;8CACG,6LAAC;oCAAM,SAAQ;oCAAQ,WAAU;8CAAU;;;;;;8CAG3C,6LAAC;oCACG,IAAG;oCACH,MAAK;oCACL,MAAK;oCACL,cAAa;oCACb,QAAQ;oCACR,OAAO;oCACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;oCACxC,WAAU;oCACV,aAAY;;;;;;;;;;;;sCAGpB,6LAAC;;8CACG,6LAAC;oCAAM,SAAQ;oCAAW,WAAU;8CAAU;;;;;;8CAG9C,6LAAC;oCACG,IAAG;oCACH,MAAK;oCACL,MAAK;oCACL,cAAa;oCACb,QAAQ;oCACR,OAAO;oCACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;oCAC3C,WAAU;oCACV,aAAY;;;;;;;;;;;;sCAIpB,6LAAC;sCACG,cAAA,6LAAC;gCACG,MAAK;gCACL,WAAU;0CACb;;;;;;;;;;;;;;;;;8BAMT,6LAAC;oBAAI,WAAU;;wBAAsB;wBACR;sCACzB,6LAAC,0KAAI;4BAAC,MAAK;4BAAS,WAAU;sCAAoD;;;;;;;;;;;;;;;;;;;;;;;AAOtG;GAzFwB;;QAIK,qIAAO;QACjB,kJAAS;;;KALJ"}}]
}